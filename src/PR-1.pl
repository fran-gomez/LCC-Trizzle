:- use_module(library(clpfd)).

:- dynamic desplazar_columna/4.
:- dynamic desplazar_fila/4.

% El predicado desplazar es el encargado principal
% de la dinamica del juego, desplazando la fila o
% columna especificada en una cantidad de lugares
% hacia una determinada direccion.
%
% +Dir: Direccion de desplazamiento de la fila o
%       columna.
% +Num: Numero de fila o columna a desplazar.
% +Cant: Cantidad de lugares a desplazar la fila
%        o columna. Requiere que sea un entero
%        entre 1 y 4.
% +Tablero: Tablero de juego sobre el cual se
%           realiza el corrimiento.
% -EvoTablero: Parametro de salida que contiene la
%              evolucion del tablero al que se le
%              aplico el movimiento. Ver docs.
desplazar("izq", Num, Cant, Tablero, EvoTablero) :-
    desplazar_fila(Num, -Cant, Tablero, EvoTablero).

desplazar("der", Num, Cant, Tablero, EvoTablero) :-
    desplazar_fila(Num, Cant, Tablero, EvoTablero).

desplazar("arriba", Num, Cant, Tablero, EvoTablero) :-
    desplazar_columna(Num, Cant, Tablero, EvoTablero).

desplazar("abajo", Num, Cant, Tablero, EvoTablero) :-
    desplazar_columna(Num, Cant, Tablero, EvoTablero).

% El predicado rotar_n desplaza una lista N posiciones
% a derecha o izquierda, segun el signo de N.
%
% +N: Cantidad de posiciones a desplazar. Derecha si
%     N > 0, izquierda si N < 0.
% +L1: Lista a rotar.
% -L2: Lista rotada.
rotar_n(0, L, L). :- !.
rotar_n(N, L1, L2) :- 
    N < 0,
    rotar("der", L1, L),
    N1 is N+1,
    rotar_n(N1, L, L2).
rotar_n(N, L1, L2) :-
    N > 0,
    rotar("izq", L1, L),
    N1 is N-1,
    rotar_n(N1, L, L2).

rotar("der", L, [T|H]) :- append(H, [T], L).
rotar("izq", [H|T], L) :- append(T, [H], L).
    
%%%%%%%%%%%%%%##%########################################%#%%%###################%###(((//////(((((((##%%%%%%%%%%%%%%%%#%############################%%%%%%%%%%%%%%%&&%&&&&&&&&&&&&&&&&&&&&&&%%%%%%%%%%%
%%%%%%%%%%%%#%######################################################################(#((/////////(((((#####%%################################%%%%%%%%%&%&&&&&&&&&&&&&&&&&&%%%%%%%%%%#%%%##%#############
%%%%%%%%###%#############%########################################################%#((#(##%%%&%((((((####################%%%#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##############################%%%%
%%%%%%%%%%%###################################################(#####################%&#&%&%&&&&&&@@&%%%%%%%%%%%%%%%%%%%%%%%&%%%%%%%%%%%%%%%%%%%%######################################%%%%%%%%%%%%%%%%%%
%%%%###################################################################%#%%%&@%&%&&&@&&&&&@%&&&@@@@@@@@@%%%&&&&&%%%%%%%%%%%%%%######################################%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&
%####################################################################%%&&&&@@@&@@@@&&@@%&&@@@&@@@@@@@@@@%&&%%%%%%%#####################################%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&%%%%%%%%%%%
%##################################################################&&&&&&&@@@@@@&&%&&&@@@@@&@@@@@@@@&@&&&&&@%##########################%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&%%%%%%%%%%%%%%%%%%%#############
%#############################################################%&%&&&&@@@@@@@@@&%%&&%%&@@@@@@@@@&%&&&@%&%@&&@@&%#%###%%%%%%%%%%%%%%%%%%%%%%%%%&%%%%%%%%%%%%%%%%%%%%######################################
%##########################################################%%&&#&&&@@@@@@@@@&&&@&&&&@@@@@@@&@&@@@@@@&&@@&@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%############################################%%%#%%%%%%%%%%%
%########################################################%&&@&&&%@@@@@@@@&@@@&&&%&&&@@&@@@@@@@@@@@@@@@@@@@@@@@@@@&%%%%%%%%%%%#############################################%%%%%%%%%%%%%%%%%%&%&&&&&&&&&&
%#######################################################%@@@&%%&@&@@@@@@@@&@@&&%&&@@@@@@@@@&@&&&@@@@@@@@@@@@@@@@@@@######################################%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&&&&&&&&&%%%%%
%########################################################@&&%%&%&&@@@@@@@@@@&%&&&@@@@&&&%@@&@&@@@@@@@@@@@@@@@@@@@@@@@&#################%%%%%%%%%%%%%%%%%%%%%%%%%&%&&&&&%&%%%%%%%%%%%%%%%%##%############
%######################################################%@@&&%&#&@@@@@@@@@@@&%%%%%&@@@@&@&@@@@@@@&&@@@@@@@@@@@@@@@@@@@@@&%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##%#%#################################
%#####################################################%@&&&&%&&@@@@@@@@@@@@&%&&&%&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&%%%%%%%%%%%%%%%#%%##%###############################################%%%%%%%%%%%
%#####################################################&@&&&@%&&&&&@@@@@@@@@@&%%%%&&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%######################################%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&
%######################################################@@@@@&&&#&&&@@@@@@@@@@&@@@&@&&&&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@######################%%%%%%%%%%%%%%%%%%&%&&&&&&&&&&&&%&&&&&&&&&&%&%%&%%%%%%%%
%####################################################%@@@@@&&%&&@@@@@@@@@@@@@&%#%&&&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%#%%%%%%%%%%%%%%%&%%%%%%&&&&&&&%&&&&&%%%%%%%%%%%%%%%%%%%%####################
%#####################################################@@@@@&%%%%&&@@@@&&%&%%%#(##%%&&&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&&&&&%&&&&&&&&%%%%%%%%%%%%%%%####################(########((((###############
%#####################################################%@@@@@@&%&@@@@&@&&%%###(//*((###%&&&&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&%%%%%%#%%###############(#((((((((#((((((((((##((##############%%%%%%%%%%%%%
%#####################################################%%@@@@@@@@@@@@@&%####(/**,,,,**///(#%%%&@&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%###########(#((((##(#####################%%%%%%%%%%%%%%%%%%&&&&&&&&&&&&&&
%#######################################################@@@@@@@@@@@&%%#(/***,,,,*/**/(#%%&%###%%%&&&&@@@@@@@@@@@@@@@@@@@@@@@@@@##############%%%%%%%%%%%%%%%%%%&&&%%%%%&&&&&&&&&&&&&&&&&&&&&&&&&&&&%&&%%
%#######################################################@@@@@@@@@&&%%(((****,*,*//((%#(/***/(#%#%%%##%%%%&&@@@@@@@@@@@@@@@@@@@@&%%%%%&%%%%%%&&&&&&&&&&&&&&&&&&&&&&&%&%%%%%%%%%%%%%%%%%%#################
%########################################################@@@@@@@@@@&&%%##(((*,,/#&&%/(&&#&&&@#%%#(/*/**/(###%&@@@@@@@@@@@@@@@@@&&&&&&&&&&%%%%%%%%%%%%%%%%%###########################(#######(#((((#(###
%########################################################@@@@@@&&%#(**//((((/,.*(%%%*********/((*,,****//(##%%&@@@&&&&@@@&@@@@@@&%#######################(##########################################%%%%
%#################################(######################@@@@@((//#@%%@@///,*,,,*#%#(*,,,**/,,,,,,****///(#%%%%%&%&%%&&%%&@@@@@@#########((##(##########################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&
%#%###########################(####(######################%@@@*(//***,*//*,,*, ,/(##(/,,,,,,,,,,,,*****/(##%%%%&%%%%%%%%%%@@@&################%#%%%%%%%%%%%%%%%%%%%%%%%%&%&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
%#########################(#####(###########################%@**,,,,,,*,.,.,*, ,*((###(/*,,,,,,******//(##%%%%%&%%%%%%%###@@@&%%%%%%%%%%%%%%%&%&%%%&&&&&&&&&&%%&%%&&%%%&%%%%%%%%%%%%%%%%%%%%%###########
%#############################(#(#############################*/,,,,..,.,**/,,..,/////*(#&#/*****////(##%%%%%&%%%%%%%%%%&&@@@&&&%&%&&%%%%%%%%%%%%%%%%%%%%%################((((((((((((((((((((((((((((((
%##########################################################(###,,,*,,,,,*#*,,,..,**/*/#%%&%#(/////(##%%%%#&%%%%%%&%%%%%%@@@@@%###############(#(#((((((((((((((((((((((((((((((((((((((((((((###########
%############################################################(#/****,***#&//,,,,*/(%@@@&%%%####(/((#%%%%#(#%%%%%&&&&&&%&%@@%###(((((((((((((((((((((((((((((((#(#####################%%%%%%%%%%%%%%%%%%%
%###############################################################(//***/#%#/***((##&&&&%%#((#%%&%///*/(#%%/((%%%&&&&&&&&&&@@@@##############################%%%%%%%%%%%%%%%%%%%%%&&%&%&&&&&&&&&&&&&&&&&&&
%#################################################################*//*/(/*/***,,,,/#(##((##%&&@@@&%**(#%%(/(#%&&&&&&&&&&&@@@@%#@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#%####
%##################################################################***/*//*(/(###%%%#((%#@@@%#%%%((/*/(#%#((&%&&@&&&&&&&@@@@@%#@@@@@@&%%%%%%%%%%%%%%%%%%%%#############(#####((((((((((#((((((((((((((((
%##################################################################******/#(/*///***,,**/(##%%%#((/(**(#%%(#&&&&&&&&@&@%@@@@@%@@@@@@@@@&&&#(((((((((((((((((((((((((((((((((((((((((((((((((((##########
%###################################################################******(/***/**/*/##%%#(#((##(//**//#&##%&&&&&&&@@@%@@@@@%@@@@@@@@@@@@@@&&&&&&((((((((((((((((((((((#######################%%%%%%%%%%
%#####################################################################****/**********/*/*//(((/(//**//(%##%&&&@&&@@@%@@@@@@%@@@@@@@@@@&@@&&&&&&&&&&&&&#######%%#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&&&&&&&&&&&
%############################################################%%%%&&&&%&/*//,,,****,,,,,,***/*///*//(#%#%%&&&&@@&&@@@@@@@@@%@@@@@@@@@@@@@@&&&&&&&&&&&%&&%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#%#
%###################################################%%%%%%%%%%%%%&&&&&&&&*//*,**,,,,,,,,****///*(#%&&%%&&&&&@@@@((@@@@@@%#@@@@@@@@@@@@@@@&&&&&&&&&%&&%&&&&&&&%&&&%%#############(##(##(((((#((((((((((((
%##############################################%&%%%%%%%%%%%%%%%%&&&%%%&&&&/(/*,**,******//((###&&&&&&&&&&@@@@(#%@@@@@@&@@@@@@@@@@@@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%%%(((((((((((((((((((####(#######
%%###########################################%&%%%%%%%%&%%%&%&%&&&&&&&&@@@@@@(/(/*//(((((#%%%%%&&%&&&&&&@&&(#&&@@@@@@%%@@@@@@@@@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&########%#%%%%%%%%%%%%%%%%%
%%%########################################%&&%&%%%&&&%&&&&&&&&&&&&&&@@@@@@@@@@&#(((%%%%%%%%%%%%%%%%%&&(((/(@@@@@@@&&@@@@@@@&@&@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&@&&&&&@@@@%%%%%&%&&&&&&&&&&&&&&&&&
%#########################################%@&&&%&%%%&&&&&&&&&&&&&&&@@@@@@@@@&&&&&@@@  %###%%%%%%%%%//((/(%@@@@@@@&%@@@@@@@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%
%########################################&&&&&&&&&&&&&&&&&&&&&&&&@@@@@@@@@&&&&&@@@@@@@ ,   ((/,////((##@@@@@@@@&%@@@@@@@&&@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&@@@@@@@@@@@@@@@@@(((((((#(##(((((###
%#######################################&&@&&%&&&&&&&&&&&&&&&&&&@@@@@@@@&&&&&&@@@@@@@@(     ..,,*///@@@@@@@&&%@@@@@@@@@@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&@&@@@@@@@@@@@@@@@@@@@@(#((((((##########
%#######################################&&@&&&&&&&&&&&&&&&&&&&@@@@@@@@@&&&&&&@@@@@@@@@/           @@@@@@#(#&@@@@@@@@@@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&@@@@@@@@@@@@@@@@@@@@@@@######%#%%%%%%%%%
%%%%%%##################################&@&&&&&&&&&&&&&&&&&&@@@@@@@@@@&&&&&&&@@@@@@@@@*          @@@@@&(&@@@@@@@@@@@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&@@@@@@@@@@@@@@@@@@@@@@@@@@&&&%&&&&&&&&&&&&&
%%#######((((((((#####################%&&&@&&&&&&&&&&&&&&&&@@@@@@@@&&&@@&((&@@@@@@@@@#*         @@@@@@@@@@@@@@@@@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&@@&&@@@@@@@@@@@@@@@@@@@@@@@@@@@&%%%%%%%%%%%##%#%
%#####(((((((((//(((#################&&&&&@&&&&&&&&&&&&&&@@@@@@@@@&#%@&@@@@@@@@@&&@@@*,.       /@@@@@@@@@@@@@@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&@@@@@&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@#((((((((((((((((
%#((((((((((((///////(((############&&&&&&&&&&&&&&&&&&&@@@@@@@@&&@%@&@@/&@@@@@@@@@@@@,,.       &&@@@@@@@@@@@@@@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&@@@@@@&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@((((((((((######
%###((((((((///(/////////((#######%&&&&&&&&&&&&&&&&&&&@&@@@@@@&&&&%#@&&&%@@@(@@@@@%@(,.      (/@@@@@@@@@@@@@@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&@@@@@@@&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@####%#%%%%%%%%%
%##((((((((((((////////////(((##&&&&&&&&&&&&&&&&&&&@&@@@@@@@@@&&&&@@@&%%&@@@@@@@@@%@/..    ,  @@@@@@@@@@@@@@@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&@@@@@@@@&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&%&&%&&&&&&&&&
%(((((((((((((((((//////((((#&&&&&&&@&&&&&&&&&&&&&&&@@@@@@@&&&&&&&@@@@%@@@@@@@@@@@@&*.       ,@@@@@@@@@@@@@@@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&@@@@@@@@&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&%%%%%%%%%%%
%((((((((((((//((((((((##%&&&&&&&&&&&@@&&@&&&&&&&@@@@@@@@&&&&&&&&&&@@@@&#@@@@@@@@@@(,.    .   @@@@@@@@@@@@&@@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&@@@@@@@&@@@@@@@@@@@@@@@@@@&@@@@@@@@@@@@@@@@@@@@@@##########
%(((((((((((((((###%&&&&&&&&&&&&&&@@@@@@@&&&&&&&&@@@@@@&&&&&&&&&&&&@@@&%&&@@@@@@@&@/,.    ....@@@@@@@@@@@@@&@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&@@@@@@@&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##########
